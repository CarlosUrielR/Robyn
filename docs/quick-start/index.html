<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-TMZK4YFDGL","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TMZK4YFDGL"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TMZK4YFDGL",{anonymize_ip:!0})</script><title data-react-helmet="true">Quick Start | Robyn</title><meta data-react-helmet="true" property="og:url" content="https://facebookexperimental.github.io/Robyn/docs/quick-start"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Quick Start | Robyn"><meta data-react-helmet="true" name="description" content="Once you have loaded all scripts, we will focus on the â€˜fb_robyn.exec.Râ€™ one to quickly start testing the code with the included simulated data and understand how to use it. Below you will find the steps to follow:"><meta data-react-helmet="true" property="og:description" content="Once you have loaded all scripts, we will focus on the â€˜fb_robyn.exec.Râ€™ one to quickly start testing the code with the included simulated data and understand how to use it. Below you will find the steps to follow:"><link data-react-helmet="true" rel="shortcut icon" href="/Robyn/img/robyn_logo.png"><link data-react-helmet="true" rel="canonical" href="https://facebookexperimental.github.io/Robyn/docs/quick-start"><link data-react-helmet="true" rel="alternate" href="https://facebookexperimental.github.io/Robyn/docs/quick-start" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://facebookexperimental.github.io/Robyn/docs/quick-start" hreflang="x-default"><link rel="stylesheet" href="/Robyn/assets/css/styles.12616227.css">
<link rel="preload" href="/Robyn/assets/js/runtime~main.a17677ab.js" as="script">
<link rel="preload" href="/Robyn/assets/js/main.ea3d8af5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Robyn/"><img src="/Robyn/img/robyn_logo.png" alt="Robyn Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Robyn/img/robyn_logo.png" alt="Robyn Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Robyn</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Robyn/docs/">Docs</a><a class="navbar__item navbar__link" href="/Robyn/docs/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookexperimental/Robyn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Robyn/"><img src="/Robyn/img/robyn_logo.png" alt="Robyn Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Robyn/img/robyn_logo.png" alt="Robyn Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Robyn</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/Robyn/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/Robyn/docs/about">About</a></li><li class="menu__list-item"><a href="https://github.com/facebookexperimental/Robyn" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">How-to guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Robyn/docs/">Installation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Robyn/docs/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Robyn/docs/step-by-step-guide">Step-by-step guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/ridge-regression">Ridge Regression</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/variable-transformations">Variable Transformations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/facebook-prophet">Facebook Prophet - Trend, Seasonality and Holiday Effects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/automated-hyperparameter-selection-optimization">Automated hyperparameter selection and optimization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/calibration">Calibration using experimental results</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/outputs-diagnostics">Outputs and diagnostics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/contributing">Getting help and contributing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Robyn/docs/about">About Robyn</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Quick Start</h1></header><p><strong>Once you have loaded all scripts, we will focus on the â€˜fb_robyn.exec.Râ€™ one to quickly start testing the code with the included simulated data and understand how to use it. Below you will find the steps to follow:</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="load-packages"></a>Load packages<a class="hash-link" href="#load-packages" title="Direct link to heading">#</a></h2><p>First, install and load all packages before running the code. You will utilize several open source packages to run it. You will find several packages related to working with data tables, loops, parallel computing and plotting results. However, the main package for the core regression process is <a href="https://cran.r-project.org/web/packages/glmnet/index.html" target="_blank" rel="noopener noreferrer">â€˜glmnetâ€™</a> from which the ridge regression will execute . Another important package is <a href="https://rstudio.github.io/reticulate/" target="_blank" rel="noopener noreferrer">â€˜reticulateâ€™</a> which provides a comprehensive set of tools for interoperability between Python and R and will be key to be able to work with <a href="https://facebookresearch.github.io/nevergrad/" target="_blank" rel="noopener noreferrer">Nevergradâ€™s</a> algorithms.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="please-make-sure-to-install-all-libraries-before-running-the-scripts"></a>Please make sure to install all libraries before running the scripts<a class="hash-link" href="#please-make-sure-to-install-all-libraries-before-running-the-scripts" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">library(glmnet)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">library(reticulate)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-install-and-use-conda-environment-for-nevergrad"></a>Create, install and use conda environment for Nevergrad<a class="hash-link" href="#create-install-and-use-conda-environment-for-nevergrad" title="Direct link to heading">#</a></h2><p>Once you have installed and loaded all packages you will need to execute the following commands in order to create, install and use conda environments on reticulate. This is required to be able to use Nevergrad algorithms which use Python:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">conda_create(&quot;r-reticulate&quot;) #must run this line once only</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">conda_install(&quot;r-reticulate&quot;, &quot;nevergrad&quot;, pip=TRUE) #must install nevergrad in conda before running Robyn</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">use_condaenv(&quot;r-reticulate&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="load-data"></a>Load data<a class="hash-link" href="#load-data" title="Direct link to heading">#</a></h2><p>First you will load the included simulated data and create the outcome variable.
As in any MMM, this is a dataframe with a minimum set of columns ds and y, containing the date and numeric value respectively. You may also want to add explanatory variables to account for different marketing channels and their investment, impressions or any other metric to determine the size and impact of marketing campaigns.
Please have in mind that this automated file reading solution requires that you are using RStudio and that it will set your working directory as the source file location in Rstudio:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### load data &amp; scripts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">script_path &lt;- str_sub(rstudioapi::getActiveDocumentContext()$path, start = 1, end = max(unlist(str_locate_all(rstudioapi::getActiveDocumentContext()$path, &quot;/&quot;))))</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dt_input &lt;- fread(paste0(script_path,&#x27;de_simulated_data.csv&#x27;)) # input time series should be daily, weekly or monthly</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dt_holidays &lt;- fread(paste0(script_path,&#x27;holidays.csv&#x27;)) # when using own holidays, please keep the header c(&quot;ds&quot;, &quot;holiday&quot;, &quot;country&quot;, &quot;year&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source(paste(script_path, &quot;fb_robyn.func.R&quot;, sep=&quot;&quot;))</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source(paste(script_path, &quot;fb_robyn.optm.R&quot;, sep=&quot;&quot;))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-model-input-variables"></a>Set model input variables<a class="hash-link" href="#set-model-input-variables" title="Direct link to heading">#</a></h2><p>The next step is to define the variables you will be working with from the previously uploaded data. There are different types of variables, the main three ones are: dependent (set_depVarName), date (set_dateVarName) and media variable names (set_mediaVarName).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### set model input variables</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_dateVarName &lt;- c(&quot;DATE&quot;) # date format must be &quot;2020-01-01&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_depVarName &lt;- c(&quot;revenue&quot;) # there should be only one dependent variable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_mediaVarName &lt;- c(&quot;tv_S&quot;    ,&quot;ooh_S&quot;,   &quot;print_S&quot;   ,&quot;facebook_I&quot;   ,&quot;search_clicks_P&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The following set of variables are related to <a href="https://facebook.github.io/prophet/" target="_blank" rel="noopener noreferrer">Prophet</a>, the open source procedure for forecasting time series data based on an additive model where non-linear trends are fit with yearly, weekly, and daily seasonality. &quot;trend&quot;,&quot;season&quot;, &quot;weekday&quot;, &quot;holiday&quot; are provided and case-sensitive. We recommend at least to keep trend and holidays if you decide to use it.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_prophet &lt;- c(&quot;trend&quot;, &quot;season&quot;, &quot;holiday&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Moreover, you will have to define which base variables (set_baseVarName) typically competitors, price, promotion, temperature, unemployment rate, etc. you own to use. In the example simulated data we use competitor_sales_B as one of the baseline variables:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_baseVarName &lt;- c(&quot;competitor_sales_B&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, you will find sign controls for variables, these will control for constrained variables that theoretically have to be greater than zero (positive), lower than zero (negative), or can take just any coefficient values (default).You will see there are media and base variables sign control so you will have to define them on separate variables:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_mediaVarSign &lt;- c(&quot;positive&quot;, &quot;positive&quot;, &quot;positive&quot;, &quot;positive&quot;, &quot;positive&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_prophetVarSign &lt;- c(&quot;default&quot;,&quot;default&quot;, &quot;default&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_baseVarSign &lt;- c(&quot;negative&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-cores-for-parallel-computing"></a>Set cores for parallel computing<a class="hash-link" href="#set-cores-for-parallel-computing" title="Direct link to heading">#</a></h2><p>Next we will define the amount of cores to allocate for computing to the overall process. Please have in mind to always leave one or two cores out of the total number of cores your machine has to prevent your OS from crashing. Use detectCores() to find out the number of cores in your machine.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">## set cores for parallel computing</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">registerDoSEQ(); detectCores()</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_cores &lt;- 6 # Use detectCores() to find out cores</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-model-training-size"></a>Set model training size<a class="hash-link" href="#set-model-training-size" title="Direct link to heading">#</a></h2><p>The next variable to set is the training size. If we set set_modTrainSize to 0.74 it means we will leave 74% of the data for training and 26% for validation. Use f.plotTrainSize to get a split estimation. Please balance between a higher Bhattacharyya coefficient and a sufficient training size. If you use the simulated data you may just leave it as it is (0.74)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">## set training size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">f.plotTrainSize(F)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_modTrainSize &lt;- 0.74</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-model-core-features"></a>Set model core features<a class="hash-link" href="#set-model-core-features" title="Direct link to heading">#</a></h2><p>The following step is crucial, this is where you will define if you will be using weibull or geometric adstock functions. Weibull is more flexible, yet has one more parameter and thus takes longer. (Please refer to the variables transformation section within this documentation for more information).
You will also need to define the number of iterations per trial for the algorithm to find optimal hyperparameter values. 500 is recommended, but just to test it on provided simulated data and reduce total computing time you may reduce this number.</p><p>After that, you will find set_hyperOptimAlgo &lt;- &quot;DiscreteOnePlusOne&quot; which is the selected algorithm for <a href="https://facebookresearch.github.io/nevergrad/index.html" target="_blank" rel="noopener noreferrer">Nevergrad</a>, the gradient-free optimization library. There is no need to change the algorithm, however there are several to choose from if you wanted to.
Finally, under â€˜set_trialâ€™ you will have to define the number of trials. 40 is recommended without calibration, 100 with calibration. If set_iter &lt;- 500 and set_trial &lt;- 40, this means that we will have 40 different initialization trials, each of them with 500 iterations.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### set model core features</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adstock &lt;- &quot;geometric&quot; # geometric or weibull.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_iter &lt;- 500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_hyperOptimAlgo &lt;- &quot;DiscreteOnePlusOne&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_trial &lt;- 40</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="set-hyperparameters-bounds"></a>Set hyperparameters bounds<a class="hash-link" href="#set-hyperparameters-bounds" title="Direct link to heading">#</a></h2><p>This is an optional step, we recommend you leave it as it is at the beginning, as there is absolutely no need to change it. You may edit bounds in case you already found optimal ranges for parameters after obtaining first results. For geometric adstock, use theta, alpha and gamma. For weibull adstock, use shape, scale, alpha and gamma.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### set hyperparameters</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">set_hyperBoundLocal &lt;- list(</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  facebook_I_alphas = c(0.5, 3) # example bounds for alpha</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ,facebook_I_gammas = c(0.3, 1) # example bounds for gamma</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ,facebook_I_thetas = c(0, 0.3) # example bounds for theta</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,facebook_I_shapes = c(0.0001, 2) # example bounds for shape</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,facebook_I_scales = c(0, 0.1) # example bounds for scale</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,ooh_S_alphas = c(0.5, 3)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,ooh_S_gammas = c(0.3, 1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,ooh_S_thetas = c(0.1, 0.4)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,ooh_S_shapes = c(0.0001, 2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,ooh_S_scales = c(0, 0.1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,print_S_alphas = c(0.5, 3)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,print_S_gammas = c(0.3, 1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ,print_S_thetas = c(0.1, 0.4)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,print_S_shapes = c(0.0001, 2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,print_S_scales = c(0, 0.1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,tv_S_alphas = c(0.5, 3)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,tv_S_gammas = c(0.3, 1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,tv_S_thetas = c(0.3, 0.8)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,tv_S_shapes = c(0.0001, 2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,tv_S_scales= c(0, 0.1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,search_clicks_P_alphas = c(0.5, 3)  </span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,search_clicks_P_gammas = c(0.3, 1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ,search_clicks_P_thetas = c(0, 0.3)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,search_clicks_P_shapes = c(0.0001, 2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> #,search_clicks_P_scales = c(0, 0.1)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="define-ground-truth-calibration"></a>Define ground-truth calibration<a class="hash-link" href="#define-ground-truth-calibration" title="Direct link to heading">#</a></h2><p>The last step in variable definition is to add ground-truth data such as incremental studies, like conversion lift data from Facebook, geo tests or Multi-touch attribution. You will need to first define activate_calibration &lt;- T to include calibration in your model. Consequently, you will need to define which channels you want to define certain incremental values for, as well as, the start date, end date and incremental absolute values (liftAbs) from the studies.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### define ground truth</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">activate_calibration &lt;- F # Switch to TRUE to calibrate model.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># set_lift &lt;- data.table(channel = c(&quot;facebook_I&quot;,  &quot;tv_S&quot;, &quot;facebook_I&quot;),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#                        liftStartDate = as.Date(c(&quot;2018-05-01&quot;, &quot;2017-11-27&quot;, &quot;2018-07-01&quot;)),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#                        liftEndDate = as.Date(c(&quot;2018-06-10&quot;, &quot;2017-12-03&quot;, &quot;2018-07-20&quot;)),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#                        liftAbs = c(400000, 300000, 200000))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prepare-the-input-data-and-run-the-models"></a>Prepare the input data and run the models<a class="hash-link" href="#prepare-the-input-data-and-run-the-models" title="Direct link to heading">#</a></h2><p>Once you have defined all the variables from previous steps, you will need to first prepare the input data within the â€˜dt_modâ€™ object. Finally, you will have to execute the â€˜f.robynâ€™ function in order to run the model.  Please set your preferred folder path (If the default &quot;~/Documents/GitHub/plots&quot; does not work out well for you) to save plots. Please notice the path has to end without a &quot;/&quot;.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Prepare input data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dt_mod &lt;- f.inputWrangling()</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Run models</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">model_output_collect &lt;- f.robyn(set_hyperBoundLocal</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ,optimizer_name = set_hyperOptimAlgo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ,set_trial = set_trial</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ,set_cores = set_cores</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ,plot_folder = &quot;~/Documents/GitHub/plots&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="access-plotted-results"></a>Access plotted results<a class="hash-link" href="#access-plotted-results" title="Direct link to heading">#</a></h2><p>Once all trials and iterations are finished, the model will proceed to plot different charts that will help you assess best models based on NRMSE and a media variables decomposition quality score for contribution of marketing channels. You may find all model plots like below example within the plot_folder you have set on the â€˜run modelsâ€™ step.</p><img alt="Model results" src="/Robyn/img/ModelResults1.png"></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebookexperimental/Robyn/docs/quick-start.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Robyn/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Robyn/docs/step-by-step-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Step-by-step guide Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#load-packages" class="table-of-contents__link">Load packages</a></li><li><a href="#create-install-and-use-conda-environment-for-nevergrad" class="table-of-contents__link">Create, install and use conda environment for Nevergrad</a></li><li><a href="#load-data" class="table-of-contents__link">Load data</a></li><li><a href="#set-model-input-variables" class="table-of-contents__link">Set model input variables</a></li><li><a href="#set-cores-for-parallel-computing" class="table-of-contents__link">Set cores for parallel computing</a></li><li><a href="#set-model-training-size" class="table-of-contents__link">Set model training size</a></li><li><a href="#set-model-core-features" class="table-of-contents__link">Set model core features</a></li><li><a href="#set-hyperparameters-bounds" class="table-of-contents__link">Set hyperparameters bounds</a></li><li><a href="#define-ground-truth-calibration" class="table-of-contents__link">Define ground-truth calibration</a></li><li><a href="#prepare-the-input-data-and-run-the-models" class="table-of-contents__link">Prepare the input data and run the models</a></li><li><a href="#access-plotted-results" class="table-of-contents__link">Access plotted results</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebookexperimental/Robyn" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/groups/954715125296621" target="_blank" rel="noopener noreferrer" class="footer__link-item">Robyn MMM Users Facebook Group</a></li><li class="footer__item"><a href="https://github.com/facebookexperimental/Robyn/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Raise an issue on Github</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/Robyn/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/Robyn/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Robyn/assets/js/runtime~main.a17677ab.js"></script>
<script src="/Robyn/assets/js/main.ea3d8af5.js"></script>
</body>
</html>